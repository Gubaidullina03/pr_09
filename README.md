# pr_09
## Геопространственный анализ данных.

## Цель:
1. Выполнять описательный анализ данных временных рядов с помощью DATETIME.
2. Использовать геопространственные данные для определения взаимосвязей.
3. Использовать сложные типы данных (массивы, JSON и JSONB).
4. Выполнять текстовую аналитику

## Практическое задание №9
Определить ближайший дилерский центр для каждого клиента. Маркетологи пытаются повысить вовлеченность клиентов, помогая им найти ближайший
к ним дилерский центр. Команда разработчиков также заинтересована в том, чтобы узнать, каково среднее расстояние между каждым покупателем и его
ближайшим дилерским центром.

## Задачи:
1. Проверить наличие геопространственных данных в базе данных.
2. Создать временную таблицу с координатами долготы и широты для каждого клиента.
3. Создать аналогичную таблицу для каждого дилерского центра.
4. Соединить эти таблицы, чтобы рассчитать расстояние от каждого клиента до каждого
дилерского центра (в киллометрах).
5. Определить ближайший дилерский центр для каждого клиента.
6. Провести выгрузку полученного результата из временной таблицы в CSV.
7. Построить карту клиентов и сервисных центров в облачной визуализации Yandex
DataLence.
8. Удалить временные таблицы.
В отчет прикрепить sql-скрипт выполненных команд с пояснениями, ссылку на
результаты в BI-системе.

## Выполнение задания:
1.	Во-первых, создадим таблицу с точками долготы и широты для каждого клиента:
```sql
CREATE TEMP TABLE customer_points AS (
SELECT
customer_id,
point(longitude, latitude) AS lng_lat_point
FROM customers
WHERE longitude IS NOT NULL
AND latitude IS NOT NULL
);

```
Получим результат:

![image](https://github.com/user-attachments/assets/82bab778-c78f-424d-a47b-4b4db55afc20)
